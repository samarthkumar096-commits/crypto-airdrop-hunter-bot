name: Telegram Bot 24/7

on:
  push:
    branches: [main]
  workflow_dispatch:
jobs:
  run-bot:
    runs-on: tenki-standard-medium-4c-8g

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt


    - name: Run Telegram Bot (Continuous)
      env:
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      run: |
        echo "üöÄ Starting Telegram Bot..."
        echo "Bot will run for 6 hours continuously"
        
        # Run bot in background
        python telegram_bot.py &
        BOT_PID=$!
        
        echo "‚úÖ Bot started with PID: $BOT_PID"
        
        # Keep bot running for 6 hours (GitHub Actions limit)
        # This allows bot to stay online continuously
        sleep 21600
        
        echo "‚è∞ 6 hours completed, stopping bot gracefully..."
        kill $BOT_PID || true